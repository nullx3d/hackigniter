trigger:
- master

pool: Default

steps:

- task: FortifySCA@7
  inputs:
    applicationType: 'other'
    fortifyBuildId: 'php'
    fortifyScanType: 'LocalScan'
    runFortifyUpload: true
    fortifyServerName: 'ssc test'
    fortifyApplicationName: 'hackigniter'
    fortifyApplicationVersion: '1'

- task: FPRUtility@2
  inputs:
    fprutilityPath: 'C:\Program Files\Fortify\FPRUtility\fprutility.exe'
    fprutilityProfile: 'My FPRUtility Profile'
    fprutilityInputPath: '**\\*.fpr'

- script: |
    if (steps.FPRUtility@2.outputs.highSeverityCount > 0) {
      Write-Host "Yüksek seviyeli bir güvenlik açığı bulundu. Akış kırılıyor."
      Exit 1
    }